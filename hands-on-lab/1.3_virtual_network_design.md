# 1.3 가상 네트워크 만들기

가상 컴퓨터와 같이 Azure에서 Network의 사용이 필요한 리소스를 생성하려면 가상 네트워크를 지정해 주어야한다. 가상 네트워크와 사용자 데이터 센터간 VPN 또는 Express Route로 사설 네트워크를 연결시킬 수 있으며, 같은 지역의 두 개의 가상 네트워크를 피어링(peering)이라는 기능을 통해 연결할 수도 있다.

가상 네트워크를 설계할 때 주의할 점은 데이터 센터와의 추가 연결을 고려하여 IP대역을 지정하는 것이 좋으며, CIDR이라는 네트워크 표기법을 이용하여 사설 가상 네트워크 대역을 정의할 때 서비스 별로 서브넷(subnet)을 나눌 수 있도록 크게 잡아두는 것이 좋다.

## 가상 네트워크 만들기

1. [Azure 웹 콘솔](https://portal.azure.com)에 접속한다.

2. 좌측 메뉴에서 **가상 네트워크**를 선택한다.
    - 좌측 메뉴에 **가상 네트워크**가 없다면, 상단의 **모든 서비스**를 선택 한 후 **가상 네트워크**를 검색하여 선택한다.

3. 블레이드에 **가상 네트워크**창이 뜨면 상단에 **추가**버튼을 눌러서 **가상 네트워크**를 생성한다.

4. **가상 네트워크 만들기** 블레이드가 뜨면 아래와 같이 설정을 입력한 후 하단에 **만들기**버튼을 클릭하여 **가상 네트워크**를 생성한다.
    - `이름`: 표시될 가상 네트워크 이름을 입력합니다. 여기서는 `krazure-vnet`으로 입력한다.
    - `주소 공간`: 가상 네트워크의 CIDR값을 입력한다. 여기서는 `10.0.0.0/22`을 입력한다.
    - `구독`: 가상 네트워크를 생성할 구독을 선택한다.
    - `리소스 그룹`: 가상 네트워크를 만들 리소스 그룹을 선택한다. **기존 그룹 사용**을 선택한 후 앞서 생성한 `krazure-rg`를 선택한다.
    - `위치`: 가상 네트워크를 생성할 지역을 선택한다. 여기서는 `아시아 남동부`를 선택한다.
    - `서브넷 이름`: 가상 네트워크를 만들 시 최초 생성시킬 서브넷 이름을 입력한다. 여기서는 `krazure-subnet`을 입력한다.
    - `서브넷 주소 범위`: 서브넷의 CIDR값을 입력한다. 이 값은 반드시 가상 네트워크의 CIDR 범위 안에 속해야 한다. 여기서는 `10.0.0.0/24`를 입력한다.
    - `DDoS 보호`: Azure DDoS 설정을 한다. 여기서는 **기본**을 선택한다.
    > [!메모]
    >
    > DDoS 보호 표준은 과금 대상이며, Azure의 DDoS팀이 직접 DDoS 관제 및 대응을 해준다.
    - `서비스 엔드포인트`: 가상 네트워크의 Endpoint를 설정하여 다른 Azure 리소스와 사설 통신을 할 수 있게 구성해 준다. 여기서는 **사용**을 선택한다.
    - `서비스`: 서비스 엔드포인트를 사용 할 서비스를 선택한다. 여기서는 드롭다운 메뉴를 클릭한 후 **Microsoft.Sql**을 선택한다.

## 웹 콘솔에서 가상 네트워크에 서브넷 추가하기

1. [Azure 웹 콘솔](https://portal.azure.com)에 접속한다.

2. 좌측 메뉴에서 **가상 네트워크**을 선택한다.
    - 좌측 메뉴에 **가상 네트워크**가 없다면, 상단의 **모든 서비스**를 선택 한 후 **가상 네트워크**를 검색하여 선택한다.

3. 생성된 `krazure-vnet`을 클릭한다.

4. `krazure-vnet` 블레이드의 좌측 메뉴에서 **설정**부분에 **서브넷**을 선택한다.

5. **가상 네트워크**를 생성할 때 만들어진 가상 네트워크를 확인한 후 상단의 **서브넷**을 클릭하여 새로운 서브넷을 만든다.

6. **서브넷 추가** 블레이드가 뜨면 아래와 같이 설정을 입력한 후 하단의 **확인**버튼을 클릭하여 **서브넷**을 생성한다.
    - `이름`: 표시될 서브넷 이름을 입력한다. 여기서는 `krazure-subnet1`을 입력한다.
    - `주소 범위(CIDR 블록)`: 서브넷의 CIDR값을 입력한다. 이 값은 반드시 가상 네트워크의 CIDR 범위 안에 속해야 한다. 여기서는 `10.0.1.0/24`를 입력한다.
    - `네트워크 보안 그룹`: 서브넷에는 **네트워크 보안 그룹**을 연결할 수 있습니다. 나중에 수정할 수 있으며, 여기서는 **없음**으로 선택한다.
    - `경로 테이블`: 서브넷에는 **사용자 지정 경로 테이블**을 설정할 수 있습니다. 나중에 수정할 수 있으며, 여기서는 **없음**으로 선택한다.
    - `서비스 엔드포인트`: 가상 네트워크의 Endpoint를 설정하여 다른 Azure 리소스와 사설통신을 할 수 있게 구성해 준다. 여기서는 **사용 안 함**을 선택한다.